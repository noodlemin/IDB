SELECT b.ordid AS "order ID", b.odate AS "order date", ptype AS "product type" FROM (SELECT ordid, odate, count(ordid) FROM (SELECT orders.ordid, odate, ptype FROM orders, details, products WHERE products.pcode=details.pcode AND orders.ordid=details.ordid GROUP by orders.ordid, ptype order by orders.ordid) as a GROUP BY ordid, odate  order by ordid) AS b, orders,details, products WHERE count=1 AND details.ordid=orders.ordid AND details.ordid=b.ordid AND orders.ordid=b.ordid AND details.pcode=products.pcode GROUP by b.ordid,b.odate,ptype;
